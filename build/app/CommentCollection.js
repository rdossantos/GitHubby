define("CommentCollection",["backbone","underscore","marked","highlightjs"],function(e,t,n,r){var i=e.Collection.extend({initialize:function(e,n){t.bindAll(this,"url"),this.issueNumber=n.issueNumber},url:function(){return"https://api.github.com/repos/rails/rails/issues/"+this.issueNumber+"/comments"},parse:function(e){return t.each(e,function(e){e.highlightedBody=e.body,e.highlightedBody=this.replaceMentionWithLink(e.highlightedBody),e.highlightedBody=this.highlightSyntax(e.highlightedBody),e.createdDate=new Date(e.created_at)},this),e},mentionRegex:/\@[\w][^\s]*/,replaceMentionWithLink:function(e){while(e.match(this.mentionRegex))e=e.replace(this.mentionRegex,this.getMentionLink);return e},getMentionLink:function(e){return'<a href="https://github.com/'+e.substring(1)+'" ><span>@</span>'+e.substring(1)+"</a>"},highlightSyntax:function(e){var i=$('<div id="highlight-wrapper">'+n(e)+"</div>"),s=i.find("pre > code");return t.each(s,function(e){var t=r.highlightAuto($(e).html()).value;i.find("pre > code").first().replaceWith(t)}),i.html()}});return i});